apiVersion: v1
kind: ConfigMap
metadata:
  name: argocd-rbac-cm
data:
{{- if .Values.config.rbacPolicy.file }}
  # An RBAC policy .csv file containing additional policy and role definitions.
  # See https://github.com/argoproj/argo-cd/blob/master/docs/rbac.md on how to write RBAC policies.
  policy.csv: |
{{ .Files.Get .Values.config.rbacPolicy.file | indent 4 }}
{{- end }}

  # The default role ArgoCD will fall back to, when authorizing API requests
  policy.default: {{ default "role:readonly" .Values.config.rbacPolicy.default }}
